{% extends "admin/base_site.html" %}

{% block content %}
<h1 style="margin-bottom: 20px;">游늵 Dashboard General</h1>

<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px;">
    
    <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
        <h3>Total Contenedores</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ total_contenedores }}</p>
    </div>

    <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
        <h3>Pagos Pendientes</h3>
        <p style="font-size: 24px; font-weight: bold; color: #d9534f;">{{ pagos_pendientes }}</p>
    </div>

    <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
        <h3>Pagos Realizados</h3>
        <p style="font-size: 24px; font-weight: bold; color: #5cb85c;">{{ pagos_realizados }}</p>
    </div>

    <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center; grid-column: span 3;">
        <h3>Documentos Obligatorios</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ documentos_obligatorios }}</p>
    </div>

    <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center; grid-column: span 3;">
        <h3>Navieras Registradas</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ navieras }}</p>
    </div>
    
    <div style="padding: 20px; background: #fff3cd; border-radius: 10px; text-align: center; grid-column: span 3;">
        <h3 style="color: #856404;">Documentos Pr칩ximos a Vencer</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ documentos_proximos }}</p>
    </div>

    <div style="padding: 20px; background: #f8d7da; border-radius: 10px; text-align: center; grid-column: span 3;">
        <h3 style="color: #721c24;"> Documentos Vencidos</h3>
        <p style="font-size: 24px; font-weight: bold;">{{ documentos_vencidos }}</p>
    </div>
    </div>

<h2>游늳 Gr치ficas</h2>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
    <canvas id="contenedoresChart"></canvas>
    <canvas id="pagosChart"></canvas>
</div>

<div style="grid-column: span 2; margin-top: 30px;">
    <h3>Evoluci칩n de Pagos</h3>
    <canvas id="evolucionPagosChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Contenedores (pie)
    const contenedoresCtx = document.getElementById('contenedoresChart').getContext('2d');
    new Chart(contenedoresCtx, {
        type: 'pie',
        data: {
            labels: {{ estados_labels|safe }},
            datasets: [{
                label: 'Contenedores',
                data: {{ estados_data|safe }},
                backgroundColor: ['#f0ad4e','#5bc0de','#0275d8','#5cb85c','#d9534f','#6c757d'],
                borderWidth: 1
            }]
        },
        options: { responsive: true }
    });

    // Pagos (barra)
    const pagosCtx = document.getElementById('pagosChart').getContext('2d');
    new Chart(pagosCtx, {
        type: 'bar',
        data: {
            labels: ['Pendientes', 'Realizados'],
            datasets: [{
                label: 'Pagos',
                // Se eliminan las comillas porque ya son n칰meros
                data: [{{ pagos_pendientes }}, {{ pagos_realizados }}], 
                backgroundColor: ['#d9534f', '#5cb85c'],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            scales: { y: { beginAtZero: true } }
        }
    });

    // Evoluci칩n de Pagos (l칤nea)
    const evolucionCtx = document.getElementById('evolucionPagosChart').getContext('2d');
    new Chart(evolucionCtx, {
        type: 'line',
        data: {
            labels: {{ pagos_labels|safe }},
            datasets: [{
                label: 'Monto de Pagos',
                data: {{ pagos_data|safe }},
                borderColor: '#007bff',
                backgroundColor: 'rgba(0, 123, 255, 0.2)',
                fill: true,
                tension: 0.3
            }]
        },
        options: {
            responsive: true,
            scales: { y: { beginAtZero: true } }
        }
    });
</script>
{% endblock %}